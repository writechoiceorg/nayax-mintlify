openapi: 3.0.1
info:
  title: E-Receipt API
  version: v1
  description: >-
    API for managing the lifecycle of digital receipts, including generation,
    status retrieval, refunds, and voids.
paths:
  /v1/eReceiptPlatform/Generate:
    post:
      tags:
        - Operations
      summary: Generate Digital Receipt
      x-mint:
        content: |
          Generates a new digital receipt using transaction, machine, and product data.
      requestBody:
        content:
          application/json-patch+json:
            schema:
              $ref: '#/components/schemas/GenerateRequest'
          application/json:
            schema:
              $ref: '#/components/schemas/GenerateRequest'
          text/json:
            schema:
              $ref: '#/components/schemas/GenerateRequest'
          application/*+json:
            schema:
              $ref: '#/components/schemas/GenerateRequest'
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/GenerateResponse'
            application/json:
              schema:
                $ref: '#/components/schemas/GenerateResponse'
            text/json:
              schema:
                $ref: '#/components/schemas/GenerateResponse'
  /v1/eReceiptPlatform/Refund:
    post:
      tags:
        - Operations
      summary: Refund Transaction
      x-mint:
        content: |
          Processes a refund for a transaction and generates an updated or
          specific refund receipt.
      requestBody:
        content:
          application/json-patch+json:
            schema:
              $ref: '#/components/schemas/RefundRequest'
          application/json:
            schema:
              $ref: '#/components/schemas/RefundRequest'
          text/json:
            schema:
              $ref: '#/components/schemas/RefundRequest'
          application/*+json:
            schema:
              $ref: '#/components/schemas/RefundRequest'
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/RefundResponse'
            application/json:
              schema:
                $ref: '#/components/schemas/RefundResponse'
            text/json:
              schema:
                $ref: '#/components/schemas/RefundResponse'
  /v1/eReceiptPlatform/Void:
    post:
      tags:
        - Operations
      summary: Void Transaction
      x-mint:
        content: Voids a transaction and its associated digital receipt.
      requestBody:
        content:
          application/json-patch+json:
            schema:
              $ref: '#/components/schemas/VoidRequest'
          application/json:
            schema:
              $ref: '#/components/schemas/VoidRequest'
          text/json:
            schema:
              $ref: '#/components/schemas/VoidRequest'
          application/*+json:
            schema:
              $ref: '#/components/schemas/VoidRequest'
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/VoidResponse'
            application/json:
              schema:
                $ref: '#/components/schemas/VoidResponse'
            text/json:
              schema:
                $ref: '#/components/schemas/VoidResponse'
  /v1/eReceiptPlatform/StartSession:
    post:
      tags:
        - Operations
      summary: Start Session
      x-mint:
        content: |
          Initiates a session between the device and the platform to prepare for
          receipt generation.
      requestBody:
        content:
          application/json-patch+json:
            schema:
              $ref: '#/components/schemas/StartSessionRequest'
          application/json:
            schema:
              $ref: '#/components/schemas/StartSessionRequest'
          text/json:
            schema:
              $ref: '#/components/schemas/StartSessionRequest'
          application/*+json:
            schema:
              $ref: '#/components/schemas/StartSessionRequest'
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/StartSessionResponse'
            application/json:
              schema:
                $ref: '#/components/schemas/StartSessionResponse'
            text/json:
              schema:
                $ref: '#/components/schemas/StartSessionResponse'
  /v1/Gateway/GetReceipt:
    post:
      tags:
        - Queries
      summary: Get Receipt Details via Gateway
      x-mint:
        content: |
          Retrieves receipt information via the gateway using payment and machine
          details.
      requestBody:
        content:
          application/json-patch+json:
            schema:
              $ref: '#/components/schemas/GatewayGetReceiptRequest'
          application/json:
            schema:
              $ref: '#/components/schemas/GatewayGetReceiptRequest'
          text/json:
            schema:
              $ref: '#/components/schemas/GatewayGetReceiptRequest'
          application/*+json:
            schema:
              $ref: '#/components/schemas/GatewayGetReceiptRequest'
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/GatewayGetReceiptResponse'
            application/json:
              schema:
                $ref: '#/components/schemas/GatewayGetReceiptResponse'
            text/json:
              schema:
                $ref: '#/components/schemas/GatewayGetReceiptResponse'
  /v1/Retry:
    post:
      tags:
        - Operations
      summary: Retry Receipt
      x-mint:
        content: Attempts to re-generate or re-send a receipt for a specific payment.
      requestBody:
        content:
          application/json-patch+json:
            schema:
              $ref: '#/components/schemas/RetryRequest'
          application/json:
            schema:
              $ref: '#/components/schemas/RetryRequest'
          text/json:
            schema:
              $ref: '#/components/schemas/RetryRequest'
          application/*+json:
            schema:
              $ref: '#/components/schemas/RetryRequest'
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/GenerateResponse'
            application/json:
              schema:
                $ref: '#/components/schemas/GenerateResponse'
            text/json:
              schema:
                $ref: '#/components/schemas/GenerateResponse'
  /v1/GetReceipt:
    post:
      summary: Get Receipt Details
      tags:
        - Queries
      x-mint:
        content: |
          Standard endpoint to retrieve receipt details based on payment success
          criteria.
      requestBody:
        content:
          application/json-patch+json:
            schema:
              $ref: '#/components/schemas/GetReceiptRequest'
          application/json:
            schema:
              $ref: '#/components/schemas/GetReceiptRequest'
          text/json:
            schema:
              $ref: '#/components/schemas/GetReceiptRequest'
          application/*+json:
            schema:
              $ref: '#/components/schemas/GetReceiptRequest'
      responses:
        '200':
          description: Success
          content:
            text/plain:
              schema:
                $ref: '#/components/schemas/GetReceiptResponse'
            application/json:
              schema:
                $ref: '#/components/schemas/GetReceiptResponse'
            text/json:
              schema:
                $ref: '#/components/schemas/GetReceiptResponse'
components:
  schemas:
    ActorInfo:
      type: object
      description: Identifies the merchant, business, and eReceipt provider.
      properties:
        nayaxActorId:
          type: integer
          format: int64
          nullable: true
        actorName:
          type: string
          nullable: true
        businessId:
          type: string
          nullable: true
        ereceiptProviderId:
          type: integer
          format: int32
          nullable: true
        ereceiptProviderUrl:
          type: string
          nullable: true
      additionalProperties: false
    CardData:
      type: object
      description: Masked payment card details used for identification on the receipt.
      properties:
        cardLast4Digits:
          type: string
          nullable: true
        cardBrand:
          type: string
          nullable: true
        nayaxConsumerId:
          type: string
          nullable: true
        cardFirst6Digits:
          type: string
          nullable: true
      additionalProperties: false
    GatewayGetReceiptRequest:
      type: object
      description: Request structure for retrieving a receipt via the Gateway endpoint.
      properties:
        paymentInfo:
          $ref: '#/components/schemas/PaymentInfo'
        machineInfo:
          $ref: '#/components/schemas/MachineInfo'
        actorInfo:
          $ref: '#/components/schemas/ActorInfo'
        additionalProperties:
          type: object
          additionalProperties: {}
          nullable: true
      additionalProperties: false
    GatewayGetReceiptResponse:
      type: object
      description: >-
        Response structure containing receipt and status information from the
        Gateway.
      properties:
        paymentInfo:
          $ref: '#/components/schemas/PaymentInfo'
        machineInfo:
          $ref: '#/components/schemas/MachineInfo'
        actorInfo:
          $ref: '#/components/schemas/ActorInfo'
        receiptDetails:
          $ref: '#/components/schemas/ReceiptDetails'
        status:
          $ref: '#/components/schemas/Status'
        additionalProperties:
          type: object
          additionalProperties: {}
          nullable: true
      additionalProperties: false
    GenerateRequest:
      type: object
      description: Full payload required to generate a new digital receipt.
      properties:
        paymentInfo:
          $ref: '#/components/schemas/PaymentInfo'
        receiptDetails:
          $ref: '#/components/schemas/ReceiptDetails'
        machineInfo:
          $ref: '#/components/schemas/MachineInfo'
        actorInfo:
          $ref: '#/components/schemas/ActorInfo'
        cardData:
          $ref: '#/components/schemas/CardData'
        products:
          type: array
          items:
            $ref: '#/components/schemas/Product'
          nullable: true
        additionalProperties:
          type: object
          additionalProperties: {}
          nullable: true
      additionalProperties: false
    GenerateResponse:
      type: object
      description: Response structure following a receipt generation request.
      properties:
        paymentInfo:
          $ref: '#/components/schemas/PaymentInfo'
        actorInfo:
          $ref: '#/components/schemas/ActorInfo'
        receiptDetails:
          $ref: '#/components/schemas/ReceiptDetails'
        status:
          $ref: '#/components/schemas/Status'
        additionalProperties:
          type: object
          additionalProperties: {}
          nullable: true
      additionalProperties: false
    GeoLocation:
      type: object
      description: Geographic coordinates and address of the physical machine.
      properties:
        state:
          type: string
          nullable: true
        city:
          type: string
          nullable: true
        countryCode:
          type: string
          nullable: true
        zipCode:
          type: string
          nullable: true
        address:
          type: string
          nullable: true
        latitude:
          type: number
          format: double
          nullable: true
        longitude:
          type: number
          format: double
          nullable: true
      additionalProperties: false
    GetReceiptRequest:
      type: object
      description: Request to retrieve a receipt with an optional success-only filter.
      properties:
        returnOnlySuccess:
          type: boolean
        paymentInfo:
          $ref: '#/components/schemas/PaymentInfo'
        additionalProperties:
          type: object
          additionalProperties: {}
          nullable: true
      additionalProperties: false
    GetReceiptResponse:
      type: object
      description: Response containing payment and receipt details.
      properties:
        paymentInfo:
          $ref: '#/components/schemas/PaymentInfo'
        receiptDetails:
          $ref: '#/components/schemas/ReceiptDetails'
        status:
          $ref: '#/components/schemas/Status'
        additionalProperties:
          type: object
          additionalProperties: {}
          nullable: true
      additionalProperties: false
    MachineInfo:
      type: object
      description: >-
        Hardware details and configuration of the device where the transaction
        occurred.
      properties:
        hwSerial:
          type: string
          nullable: true
        nayaxMachineId:
          type: integer
          format: int64
          nullable: true
        nayaxMachineName:
          type: string
          nullable: true
        geoLocation:
          $ref: '#/components/schemas/GeoLocation'
        machineTimezoneOffset:
          type: number
          format: double
          nullable: true
        machineType:
          $ref: '#/components/schemas/MachineInfoMachineType'
      additionalProperties: false
    MachineInfoMachineType:
      description: Enum representing the type/model of the hardware machine.
      enum:
        - 0
        - 1
        - 2
        - 3
        - 4
        - 5
        - 6
        - 7
        - 8
        - 9
        - 10
        - 11
        - 12
        - 13
        - 14
        - 15
        - 16
        - 17
        - 18
        - 19
        - 20
        - 21
        - 22
        - 23
        - 24
        - 25
        - 26
        - 27
        - 28
        - 29
        - 30
        - 31
        - 32
        - 33
        - 34
        - 37
        - 38
        - 39
        - 40
        - 41
        - 42
        - 43
        - 44
        - 45
        - 46
        - 47
        - 48
      type: integer
      format: int32
    PaymentInfo:
      type: object
      description: Detailed data regarding the financial transaction and its timestamps.
      properties:
        nayaxTransactionId:
          type: integer
          format: int64
        authCode:
          type: string
          nullable: true
        settAmount:
          type: number
          format: double
          nullable: true
        refundAmount:
          type: number
          format: double
          nullable: true
        machineAuTime:
          type: string
          nullable: true
        machineSeTime:
          type: string
          nullable: true
        auTime:
          type: string
          nullable: true
        seTime:
          type: string
          nullable: true
        refundDateTime:
          type: string
          nullable: true
        currencyCode:
          type: string
          nullable: true
        currencyNumeric:
          type: string
          nullable: true
        paymentType:
          $ref: '#/components/schemas/PaymentInfoPaymentType'
        snapshotId:
          type: integer
          format: int64
          nullable: true
        sessionTransactionId:
          type: string
          nullable: true
        siteId:
          type: integer
          format: int32
        nayaxRRN:
          type: string
          nullable: true
        fiscalRrn:
          type: string
          nullable: true
      additionalProperties: false
    PaymentInfoPaymentType:
      description: Enum representing the payment method used.
      enum:
        - 0
        - 1
        - 2
        - 3
        - 4
        - 5
        - 6
        - 7
      type: integer
      format: int32
    Product:
      type: object
      description: Itemized details of a product included in the transaction.
      properties:
        productCode:
          type: string
          nullable: true
        productName:
          type: string
          nullable: true
        price:
          type: number
          format: double
          nullable: true
        unitOfMeasurement:
          type: string
          nullable: true
        measurement:
          type: number
          format: double
          nullable: true
        taxId:
          type: string
          nullable: true
        taxValue:
          type: number
          format: double
          nullable: true
      additionalProperties: false
    ReceiptDetails:
      type: object
      description: >-
        Final receipt metadata including totals, counts, and the hosted receipt
        URL.
      properties:
        additionalData:
          type: string
          nullable: true
        totalAmount:
          type: number
          format: double
          nullable: true
        totalProductCount:
          type: integer
          format: int32
          nullable: true
        vatTotal:
          type: number
          format: double
          nullable: true
        amountBeforeVat:
          type: number
          format: double
          nullable: true
        discount:
          type: number
          format: double
          nullable: true
        moneySaved:
          type: number
          format: double
          nullable: true
        eReceiptPlatformId:
          type: integer
          format: int64
          nullable: true
        receiptId:
          type: string
          nullable: true
        receiptUrl:
          type: string
          nullable: true
        originalEReceiptPlatformId:
          type: integer
          format: int64
          nullable: true
        invoiceNumber:
          type: string
          nullable: true
        originalInvoiceNumber:
          type: string
          nullable: true
      additionalProperties: false
    RefundRequest:
      type: object
      description: Request payload to initiate a refund for a transaction.
      properties:
        paymentInfo:
          $ref: '#/components/schemas/PaymentInfo'
        machineInfo:
          $ref: '#/components/schemas/MachineInfo'
        actorInfo:
          $ref: '#/components/schemas/ActorInfo'
        cardData:
          $ref: '#/components/schemas/CardData'
        receiptDetails:
          $ref: '#/components/schemas/ReceiptDetails'
        additionalProperties:
          type: object
          additionalProperties: {}
          nullable: true
      additionalProperties: false
    RefundResponse:
      type: object
      description: Response structure following a refund request.
      properties:
        paymentInfo:
          $ref: '#/components/schemas/PaymentInfo'
        actorInfo:
          $ref: '#/components/schemas/ActorInfo'
        receiptDetails:
          $ref: '#/components/schemas/ReceiptDetails'
        status:
          $ref: '#/components/schemas/Status'
        additionalProperties:
          type: object
          additionalProperties: {}
          nullable: true
      additionalProperties: false
    RetryRequest:
      type: object
      description: Request to re-process or re-attempt receipt generation.
      properties:
        paymentInfo:
          $ref: '#/components/schemas/PaymentInfo'
        additionalProperties:
          type: object
          additionalProperties: {}
          nullable: true
      additionalProperties: false
    StartSessionRequest:
      type: object
      description: Request to establish a secure session for a device.
      properties:
        hwSerial:
          type: string
          nullable: true
        nayaxMachineId:
          type: integer
          format: int64
          nullable: true
        ereceiptProviderId:
          type: integer
          format: int32
          nullable: true
        startSessionToken:
          type: string
          nullable: true
        nayaxTransactionId:
          type: integer
          format: int64
          nullable: true
        randomNumber:
          type: string
          nullable: true
        dynamicURL:
          type: string
          nullable: true
      additionalProperties: false
    StartSessionResponse:
      type: object
      description: >-
        Response containing transaction IDs and status following session
        initiation.
      properties:
        tranId:
          type: string
          nullable: true
        tranIDCipher:
          type: string
          nullable: true
        status:
          $ref: '#/components/schemas/Status'
      additionalProperties: false
    Status:
      type: object
      description: >-
        General status object containing error codes and messages for any API
        response.
      properties:
        verdict:
          type: string
          nullable: true
        responseCode:
          $ref: '#/components/schemas/StatusResponseCode'
        errors:
          type: array
          items:
            type: string
          nullable: true
        providerErrorCode:
          type: integer
          format: int32
          nullable: true
        statusMessage:
          type: string
          nullable: true
      additionalProperties: false
    StatusResponseCode:
      description: Numeric status codes indicating success or specific failure categories.
      enum:
        - 0
        - 301
        - 302
        - 990
        - 992
        - 998
        - 999
      type: integer
      format: int32
    VoidRequest:
      type: object
      description: Request to void a specific transaction and its receipt record.
      properties:
        paymentInfo:
          $ref: '#/components/schemas/PaymentInfo'
        machineInfo:
          $ref: '#/components/schemas/MachineInfo'
        actorInfo:
          $ref: '#/components/schemas/ActorInfo'
        cardData:
          $ref: '#/components/schemas/CardData'
        receiptDetails:
          $ref: '#/components/schemas/ReceiptDetails'
        additionalProperties:
          type: object
          additionalProperties: {}
          nullable: true
      additionalProperties: false
    VoidResponse:
      type: object
      description: Response structure following a void request.
      properties:
        paymentInfo:
          $ref: '#/components/schemas/PaymentInfo'
        actorInfo:
          $ref: '#/components/schemas/ActorInfo'
        receiptDetails:
          $ref: '#/components/schemas/ReceiptDetails'
        status:
          $ref: '#/components/schemas/Status'
        additionalProperties:
          type: object
          additionalProperties: {}
          nullable: true
      additionalProperties: false
security:
  - {}
